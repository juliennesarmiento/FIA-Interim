#! /bin/bash

bold=$(tput bold)
normal=$(tput sgr0)
printf "\n \033[0;30${bold}mChecking for Presence of User .rhosts Files${normal} \n\n" 

for dir in `/bin/cat /etc/passwd | /bin/egrep -v '(root|halt|sync|shutdown)' |/bin/awk -F: '($7 != "/sbin/nologin") { print $6 }'`; do

for file in $dir/.rhosts; do

if [ ! -h "$file" -a -f "$file" ]; then
printf "\033[33;31m.rhosts file found in $dir, please delete file if it is not needed. \n"
else
printf "\033[33;32mNo .rhosts file found in $dir \n"
fi
echo  -en "\e[0m"
done
done
