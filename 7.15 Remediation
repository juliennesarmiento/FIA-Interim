#!/bin/bash

#7.15
#If any users have .rhosts files determine why they have them. These files should be deleted if they are not needed.
#To search for and remove .rhosts files by using the find(1) command
printf "Checking for presence of user .rhosts files: "

for dir in `/bin/cat /etc/passwd | /bin/egrep -v '(root|halt|sync|shutdown)' |/bin/awk -F: '($7 != "/sbin/nologin") { print $6 }'`; do

for file in $dir/.rhosts; do
if [ ! -h "$file" -a -f "$file" ]; then

	find /export/home -name .rhosts -print | xargs -i -t rm{}
		printf "\e[32mRemediation has been completed \n"
else

	printf "\e[32mNo remediation needed\e[0m\n"
fi


done
done
